#!/bin/bash


export PREFIX="$HOME/opt/cross"
export TARGET=i686-elf
export PATH="$HOME/opt/cross/bin:$PATH"




nasm -f elf32 multiboot_header.asm
nasm -f elf32 boot.asm
$TARGET-ld -n -o kernel.bin -T linker.ld multiboot_header.o boot.o

if grub2-file --is-x86-multiboot kernel.bin; then
  echo multiboot confirmed
else
  echo the file is not multiboot
fi

sudo cp kernel.bin ./iso/boot/kernel.bin
grub2-mkrescue -o myos.iso iso
cp myos.iso /mnt/windows/myos-test.iso
#rm *.o